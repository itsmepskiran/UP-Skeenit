<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Skreenit - Registration</title>

  <link rel="icon" type="image/png" sizes="32x32" href="https://auth.skreenit.com/assets/images/favicon-32x32.png" />
  <link rel="stylesheet" href="https://auth.skreenit.com/assets/css/shared-styles.css" />
  <link rel="stylesheet" href="https://auth.skreenit.com/assets/css/auth.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />

  <style>
    .form-row { display: flex; gap: 15px; margin-bottom: 15px; }
    .form-row .form-group { flex: 1; }
    .password-hint { font-size: 12px; color: #666; margin-top: 4px; }
    .auth-actions { text-align: center; margin-top: 20px; color: #666; }
    .auth-actions a { color: #1976d2; text-decoration: none; font-weight: 500; }
    .auth-actions a:hover { text-decoration: underline; }
    .form-group select {
      width: 100%; padding: 10px; border: 1px solid #ddd;
      border-radius: 4px; font-size: 14px;
    }
  </style>
</head>

<body>
  <div class="floating-elements" style="pointer-events:none;">
    <div class="floating-circle"></div>
    <div class="floating-circle"></div>
    <div class="floating-circle"></div>
    <div class="floating-circle"></div>
  </div>

  <a href="https://skreenit.com" class="logo-link">
    <img src="https://auth.skreenit.com/assets/images/logo.png" alt="Skreenit" />
  </a>

  <div class="auth-wrapper">
    <img src="https://auth.skreenit.com/assets/images/logobrand.png" class="brand-image" />

    <div class="auth-header">
      <h1><i class="fas fa-user-plus"></i> Create an Account</h1>
      <p>Please enter your details to register</p>
    </div>

    <div class="auth-body">
      <div id="formError" class="error-message"></div>

      <form id="registrationForm">
        <div class="form-group">
          <label>Register as*</label>
          <select id="role" name="role" required>
            <option value="">Select your role</option>
            <option value="candidate">üë§ Candidate</option>
            <option value="recruiter">üè¢ Recruiter</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Full Name*</label>
            <input type="text" name="full_name" placeholder="Enter your name" required />
          </div>
          <div class="form-group">
            <label>Mobile*</label>
            <input type="tel" name="mobile" placeholder="Enter mobile number" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Email*</label>
            <input type="email" name="email" placeholder="Enter your email" required />
          </div>
          <div class="form-group">
            <label>Location*</label>
            <input type="text" name="location" placeholder="Enter location" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Password*</label>
            <div style="position: relative;">
              <input type="password" id="password" name="password" placeholder="Create password"
                     minlength="8" required
                     pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]+" />
              <i class="fas fa-eye" style="position: absolute; right: 10px; top: 10px; cursor: pointer;"
                 onclick="togglePassword('password')"></i>
            </div>
            <div class="password-hint">
              8+ characters, with uppercase, lowercase, number & special character
            </div>
          </div>

          <div class="form-group">
            <label>Confirm Password*</label>
            <div style="position: relative;">
              <input type="password" id="confirmPassword" name="confirmPassword"
                     placeholder="Confirm password" required />
              <i class="fas fa-eye" style="position: absolute; right: 10px; top: 10px; cursor: pointer;"
                 onclick="togglePassword('confirmPassword')"></i>
            </div>
          </div>
        </div>

        <div class="form-footer" style="margin: 15px 0; text-align: center; font-size: 13px; color: #666;">
          By creating an account, you agree to our
          <a href="legal/terms-conditions.html" target="_blank">Terms & Conditions</a> and
          <a href="legal/privacy-policy.html" target="_blank">Privacy Policy</a>
        </div>

        <button type="submit" class="btn btn-primary btn-large" style="width:100%; margin-top: 10px;">
          <i class="fas fa-user-plus"></i> Create Account
        </button>

        <div class="auth-actions">
          Already have an account? <a href="login.html">Sign in</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Attach registration handler -->
  <script type="module">
    import { handleRegistrationSubmit } from "https://auth.skreenit.com/assets/js/registration.js";

    const form = document.getElementById("registrationForm");
    const errorDiv = document.getElementById("formError");

    // Password toggle stays local
    window.togglePassword = (inputId) => {
      const input = document.getElementById(inputId);
      const icon = event.currentTarget;
      if (input.type === "password") {
        input.type = "text";
        icon.classList.replace("fa-eye", "fa-eye-slash");
      } else {
        input.type = "password";
        icon.classList.replace("fa-eye-slash", "fa-eye");
      }
    };

    // Attach handler
    form.addEventListener("submit", async (e) => {
      errorDiv.style.display = "none";
      const success = await handleRegistrationSubmit(e);

      if (!success) {
        errorDiv.textContent = "Registration failed. Please check your details.";
        errorDiv.className = "alert alert-error";
        errorDiv.style.display = "block";
      }
    });
  </script>

</body>
</html>
